{% load staticfiles %}
<script src="https://www.google.com/jsapi" type="text/javascript"></script>
<script src="{% static 'RoadAccidentStatistics/js/jquery-2.1.0.js' %}" type="text/javascript"></script>
<script src="{% static 'RoadAccidentStatistics/js/bootstrap.min.js' %}" type="text/javascript"></script>
<script src="{% static 'RoadAccidentStatistics/js/chosen.jquery.js' %}" type="text/javascript"></script>
<script src="{% static 'RoadAccidentStatistics/js/chart.draw.functions.js' %}" type="text/javascript"></script>
<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    $(document).ready(function(){
        $('.chosen-select').chosen().change(function() {
            // remove '&nbsp;'
            $('.search-choice span').each(function() {
                $(this).text($(this).text().trim());
            });
        });
    });
    function getSelectedRegions(){
        var a = [];
        $('.search-choice span').each(function() {
                a[a.length] = $(this).text();
        });
        return a;
    }
    function getFullURL(url) {
        var i = document.URL.indexOf('?');
        return (i < 0 ? document.URL : document.URL.substr(0, i)) + url;
    }
    function show(chartTypeName) {
        var url = getURL();
        startLoadAnimation();
        $.ajax({
            url: url + "/data",
            dataType: "json"
        })
        .success(function(data) {
                chart = draw2D(chart, 'chart', chartTypeName, data.chart_title, data.xAxis_title, data.vAxis_title,
                    data.chart_data, false, false);
                $("#url").text(getFullURL(url));
        })
        .fail(function() {
                alert("Connection with server is lost")
        })
        .always(function() {
                stopLoadAnimation();
        });
    }
</script>